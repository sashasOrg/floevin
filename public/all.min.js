angular.module("SashasApp",["ui.router","ngCookies","ui.bootstrap","ngStorage","chart.js"]),angular.module("SashasApp").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/",templateUrl:"/home.html",controller:"mainController",access:{restricted:!1}}).state("questionaire",{url:"/questionaire",templateUrl:"/questionaire.html",controller:"questionaireController",access:{restricted:!1}}).state("login",{url:"/",template:"<login></login>",access:{restricted:!1}}).state("register",{url:"/register",templateUrl:"<register></register>",controller:"registerController",access:{restricted:!1}}).state("portfolio",{url:"/portfolio",templateUrl:"/portfolio.html",controller:"userController",access:{restricted:!0}}).state("fundtable",{url:"/fundtable",templateUrl:"/fundtable.html",controller:"fundController",access:{restricted:!1}}).state("fundinfo",{url:"/fundinfo",templateUrl:"/fundinfo.html",controller:"fundController",access:{restricted:!1}}).state("admin",{url:"/admin",templateUrl:"/admin.html",controller:"fundController",access:{restricted:!0}}).state("recommendations",{url:"/portfolio/recommendations",templateUrl:"/recommendations.html",controller:"userController",access:{restricted:!0}}),t.otherwise("/")}]),angular.module("SashasApp").run(["$state","$cookies","$rootScope","$location","$localStorage","AuthService",function(e,t,r,o,l,s){r.$on("$stateChangeStart",function(t,r,o){s.getUserStatus(),r.access.restricted&&!l.currentUser&&(t.preventDefault(),e.go("login"))})}]);
angular.module("SashasApp").controller("loginController",["$state","$scope","$location","$localStorage","$cookies","AuthService","mainService",function(e,r,o,t,a,s,n){r.isLoggedIn=s.isLoggedIn,r.getBarInfo=function(){t.goodBarData={},t.goodBarData.data=[],t.goodBarData.labels=[],t.goodBarData.series=["Price"],t.bestBarData={},t.bestBarData.data=[],t.bestBarData.labels=[],t.bestBarData.series=["Price"];for(var e=0;e<t.currentUser.bestMatches.length;e++)n.getMoreInformation(t.currentUserBestMatches.bestMatches[e].symbol.toUpperCase()).then(function(e){t.goodBarData.data.push(parseInt(e.data.query.results.quote.PreviousClose)),t.goodBarData.labels.push(e.data.query.results.quote.Symbol)});for(var e=0;e<t.currentUser.goodMatches.length;e++)n.getMoreInformation(t.currentUserGoodMatches.goodMatches[e].symbol.toUpperCase()).then(function(e){t.goodBarData.data.push(parseInt(e.data.query.results.quote.PreviousClose)),t.goodBarData.labels.push(e.data.query.results.quote.Symbol)})},r.login=function(){r.error=!1,r.disabled=!0,s.login(r.loginForm.username,r.loginForm.password).then(function(o){r.disabled=!1,r.loginForm={},s.isLoggedIn(),t.currentUser=o,n.getUserPortfolio(t.currentUser.username).then(function(o){t.currentUserPortfolio=o.data,n.getBadMatches(t.currentUser.username).then(function(o){t.currentUserBadMatches=o.data,n.getOkayMatches(t.currentUser.username).then(function(o){t.currentUserOkayMatches=o.data,n.getGoodMatches(t.currentUser.username).then(function(o){t.currentUserGoodMatches=o.data,n.getBestMatches(t.currentUser.username).then(function(o){t.currentUserBestMatches=o.data,r.getBarInfo(),e.go("portfolio")})})})})})})["catch"](function(){r.error=!0,r.errorMessage="Invalid username and/or password",r.disabled=!1,r.loginForm={}})}}]),angular.module("SashasApp").controller("logoutController",["$scope","$location","$cookies","$localStorage","AuthService","mainService",function(e,r,o,t,a,s){e.userLogged=a.isLoggedIn(),e.$watch(e.userLogged),e.checkForUser=function(){return!t.currentUser},e.logout=function(){a.logout().then(function(){t.$reset(),r.path("login")})}}]),angular.module("SashasApp").controller("registerController",["$scope","$location","AuthService",function(e,r,o){e.secondPassword="",e.register=function(){return e.registerForm.password!==e.registerForm.secondPassword?(e.error=!0,e.errorMessage="Passwords do not match, please re-enter password.",e.registerForm.password="",e.registerForm.secondPassword="",!1):(e.error=!1,e.disabled=!0,void o.register(e.registerForm.username,e.registerForm.password,e.registerForm.firstName,e.registerForm.lastName,e.registerForm.email).then(function(){r.path("login"),e.disabled=!1,e.registerForm={}})["catch"](function(){e.error=!0,e.errorMessage="Something went wrong!",e.disabled=!1,e.registerForm={}}))}}]);

angular.module("SashasApp").controller("fundController",["$scope","$cookies","$state","$localStorage","fundService","mainService",function(t,r,e,o,n,a){t.seachFund="",t.orderByField="",t.reverseSort=!1,t.fundData=o.fundData,t.chartData=o.chartData,t.data=o.data,t.$watch(t.data),t.labels=o.labels,t.$watch(t.labels),t.series=["High","Low","Open"],t.onClick=function(t,r){},t.getChartInfo=function(r){t.disabled=!0,a.chartData={},a.chartData.data=[],a.getChartInfo(r.toUpperCase()).then(function(u){for(var i=0;i<u.data.query.results.quote.length;i++){var f=(u.data.query.results.quote[i].Date.split("-"),{});f.Open=u.data.query.results.quote[i].Open,f.Low=u.data.query.results.quote[i].Low,f.High=u.data.query.results.quote[i].High,f.Close=u.data.query.results.quote[i].Close,f.Volume=u.data.query.results.quote[i].Volume,f.Date=u.data.query.results.quote[i].Date,f._date_Date=f.Date,a.chartData.data.push(f)}o.chartData=a.chartData,t.chartData=o.chartData,a.getMoreInformation(r).then(function(u){a.specificData=u.data.query.results.quote,o.fundData=a.specificData,t.data=[],t.data[0]=[],t.data[1]=[],t.data[2]=[],t.labels=[];for(var i=t.chartData.data.reverse(),f=0;f<t.chartData.data.length;f++)t.labels.push(i[f].Date),t.data[0].push(i[f].High),t.data[1].push(i[f].Low),t.data[2].push(i[f].Open);o.data=t.data,o.labels=t.labels,i=null,n.searchFund(r).then(function(r){o.fundData=r.data.list.resources[0].resource.fields,t.disabled=!1,e.go("fundinfo")})})})},t.createRiskCompatability=function(){n.getFund().then(function(r){t.fundStuff=r.data;for(var e=0;e<t.fundStuff.length;e++)t.fundStuff[e].riskCompatibility=2*t.fundStuff[e].riskPotential+2*t.fundStuff[e].riskBracket,t.fundStuff[e].riskCompatibility=5*t.fundStuff[e].riskCompatibility,n.updateFund(t.fundStuff[e]._id,t.fundStuff[e]).then(function(t){})})},t.createRiskCompatability(),t.changeMutualFund=function(r){t.changedFund=r},t.updateMutualFund=function(r){n.updateFund(r._id,r).then(function(r){t.changedFund={}})["catch"](function(r){t.changedFund={}})},t.anyfund=function(){t.error=!1,t.disabled=!0,n.newFund(t.newfundForm)},t.fundQuery=function(){n.fundQuery(t.searchFund).then(function(r){t.fund=r})},t.getFund=function(){n.getFund().then(function(r){t.fundinfo=r.data})},t.getFund(),t.newFund=function(r,e,o,a,u,i,f,s){n.newFund(r,e,o,a,u,i,f,s).then(function(r){t.getFund()})},t.toggle=function(){t.showing=!t.showing},t.showing=!1,t.addToPortfolio=function(r,e,n){if(!n)return!1;for(var u=o.currentUser,i=0;i<u.portfolio.length;i++)if(r===o.currentUser.portfolio[i])return!1;u.portfolio.push(r),u.portfolioNumber.push({number:n,name:e}),o.currentUser=u,t.currentUserCookie=o.currentUser,n="",a.updateUser(u),a.getUserPortfolio(u.username).then(function(r){o.currentUserPortfolio=r.data,t.currentUserPortfolioCookie=o.currentUserPortfolio})},t.checkPortfolio=function(t){for(var r=o.currentUser,e=0;e<r.portfolio.length;e++)if(t===o.currentUser.portfolio[e])return!0;return!1},t.calculatePortfolioPrice=function(){var r=o.currentUser;r.portfolioPrice=0;for(var e=0;e<o.currentUserPortfolio.portfolio.length;e++){var n=o.currentUserPortfolio.portfolioNumber[e].number;a.getMutualInfo(o.currentUserPortfolio.portfolio[e].symbol.toUpperCase()).then(function(e){var u=parseInt(e.data.list.resources[0].resource.fields.price),i=u*n;r.portfolioPrice=r.portfolioPrice+i,a.updateUser(r),o.currentUser=r,a.getUserPortfolio(o.currentUser.username).then(function(r){o.currentUserPortfolio=r.data,t.currentUserPortfolioCookie=o.currentUserPortfolio})})}},t.removeFromPortfolio=function(r){if(1===o.currentUser.portfolio.length){var e=o.currentUser;e.portfolio=[],e.portfolioNumber=[],o.currentUser=e,a.updateUser(e),a.getUserPortfolio(o.currentUser.username).then(function(r){o.currentUserPortfolio=r.data,t.currentUserPortfolioCookie=o.currentUserPortfolio,t.calculatePortfolioPrice()})}a.getUserPortfolio(o.currentUser.username).then(function(r){o.currentUserPortfolio=r.data,t.currentUserPortfolioCookie=o.currentUserPortfolio});for(var n=0;n<o.currentUser.portfolio.length;n++)if(r===o.currentUser.portfolio[n]){var u=o.currentUser;u.portfolio.splice(n,1),u.portfolioNumber.splice(n,1),o.currentUser=u,a.updateUser(u),a.getUserPortfolio(o.currentUser.username).then(function(r){o.currentUserPortfolio=r.data,t.currentUserPortfolioCookie=o.currentUserPortfolio,t.calculatePortfolioPrice()})}}}]),angular.module("SashasApp").directive("hideForm",function(){function t(t,r,e){var o=e.hideForm;t.$eval(o)||r.hide(),t.$watch(o,function(t,e){t!==e&&(t?r.stop(!0,!0).slideDown():r.stop(!0,!0).slideUp())})}return{link:t,restrict:"A"}});
angular.module("SashasApp").controller("mainController",["$scope","$state","$cookies","$localStorage","mainService","fundService",function(e,a,t,r,o,s){e.data=o.data,e.stockQuery="",e.mainService={},e.checkForUser=function(){return!r.currentUser},e.searchFund=function(e){s.searchFund(e).then(function(e){r.fundData=e.data.list.resources[0].resource.fields,a.reload()})},e.getFunds=function(){s.getFund().then(function(a){e.fundInfo=a.data})},e.getFunds(),e.getMoreInformation=function(e){o.getMoreInformation(e).then(function(e){o.specificData=e.data.query.results.quote,a.reload()})},e.getBarInfo=function(){r.goodBarData={},r.goodBarData.data=[],r.goodBarData.labels=[],r.goodBarData.series=["Price"],r.bestBarData={},r.bestBarData.data=[],r.bestBarData.labels=[],r.bestBarData.series=["Price"];for(var e=0;e<r.currentUser.bestMatches.length;e++)o.getMoreInformation(r.currentUserBestMatches.bestMatches[e].symbol.toUpperCase()).then(function(e){r.goodBarData.data.push(parseInt(e.data.query.results.quote.PreviousClose)),r.goodBarData.labels.push(e.data.query.results.quote.Symbol)});for(var e=0;e<r.currentUser.goodMatches.length;e++)o.getMoreInformation(r.currentUserGoodMatches.goodMatches[e].symbol.toUpperCase()).then(function(e){r.goodBarData.data.push(parseInt(e.data.query.results.quote.PreviousClose)),r.goodBarData.labels.push(e.data.query.results.quote.Symbol)})},r.currentUser&&e.getBarInfo(),$("#slideshow > div:gt(0)").hide(),setInterval(function(){$("#slideshow > div:first").fadeOut(6e3).next().fadeIn(6e3).end().appendTo("#slideshow")},1e4)}]);
angular.module("SashasApp").controller("questionaireController",["$scope","$cookies","$state","$window","$localStorage","questionaireService","mainService",function(e,n,r,i,t,a,c){e.age_answer=[],e.age_answer[30]=10,e.age_answer[3040]=8,e.age_answer[4050]=6,e.age_answer[5065]=4,e.age_answer[65]=2,e.objective_answer=[],e.objective_answer.Spec=10,e.objective_answer.Growth=8,e.objective_answer.Income=6,e.objective_answer.Tax=4,e.objective_answer.Safety=1,e.income_answer=[],e.income_answer.I50=2,e.income_answer.I50100=4,e.income_answer.I100250=6,e.income_answer.I250500=8,e.income_answer.I500=10,e.timeFrame_answer=[],e.timeFrame_answer["6mo1yr"]=1,e.timeFrame_answer["1to3yr"]=4,e.timeFrame_answer["3to5yr"]=6,e.timeFrame_answer["5to7yr"]=8,e.timeFrame_answer["7+"]=10,e.liquidity_answer=[],e.liquidity_answer.Low=2,e.liquidity_answer["Medium-Low"]=4,e.liquidity_answer.Medium=6,e.liquidity_answer["Medium-High"]=8,e.liquidity_answer.High=10,e.experience_answer=[],e.experience_answer["Low-Experience"]=2,e.experience_answer["Medium-Low-Experience"]=4,e.experience_answer["Medium-Experience"]=6,e.experience_answer["Medium-High-Experience"]=8,e.experience_answer["High-Experience"]=10,e.stockexperience_answer=[],e.stockexperience_answer["Low-Experience-Stock"]=2,e.stockexperience_answer["Medium-Low-Experience-Stock"]=4,e.stockexperience_answer["Medium-Experience-Stock"]=6,e.stockexperience_answer["Medium-High-Experience-Stock"]=8,e.stockexperience_answer["High-Experience-Stock"]=10,e.bondexperience_answer=[],e.bondexperience_answer["Low-Experience-bond"]=2,e.bondexperience_answer["Medium-Low-Experience-bond"]=4,e.bondexperience_answer["Medium-Experience-bond"]=6,e.bondexperience_answer["Medium-High-Experience-bond"]=8,e.bondexperience_answer["High-Experience-bond"]=10,function(n){e.data={repeatSelect:null,availableOptions:[{id:"...",name:""},{id:.8,name:"Limited"},{id:.85,name:"Some"},{id:.9,name:"Good"},{id:.95,name:"Expert"},{id:1,name:"Professional"}]}}(window.angular),e.getAge=function(){for(var n=0,r=document.forms.form,i=r.elements.ageselected,t=0;t<i.length;t++)if(i[t].checked){n=e.age_answer[i[t].value];break}return n},e.getObjective=function(){for(var n=0,r=document.forms.form,i=r.elements.objectiveselected,t=0;t<i.length;t++)if(i[t].checked){n=e.objective_answer[i[t].value];break}return n},e.getIncome=function(){for(var n=0,r=document.forms.form,i=r.elements.incomeselected,t=0;t<i.length;t++)if(i[t].checked){n=e.income_answer[i[t].value];break}return n},e.getTimeFrame=function(){for(var n=0,r=document.forms.form,i=r.elements.timeframeselected,t=0;t<i.length;t++)if(i[t].checked){n=e.timeFrame_answer[i[t].value];break}return n},e.getLiquidity=function(){for(var n=0,r=document.forms.form,i=r.elements.liquidityselected,t=0;t<i.length;t++)if(i[t].checked){n=e.liquidity_answer[i[t].value];break}return n},e.getExperience=function(){for(var n=0,r=document.forms.form,i=r.elements.experienceselected,t=0;t<i.length;t++)if(i[t].checked){n=e.experience_answer[i[t].value];break}return n},e.getStockExperience=function(){for(var n=0,r=document.forms.form,i=r.elements.stockexperienceselected,t=0;t<i.length;t++)if(i[t].checked){n=e.stockexperience_answer[i[t].value];break}return n},e.getBondExperience=function(){for(var n=0,r=document.forms.form,i=r.elements.bondexperienceselected,t=0;t<i.length;t++)if(i[t].checked){n=e.bondexperience_answer[i[t].value];break}return n},e.calculateTotal=function(){e.disabled=!0;var n=(e.getAge()+e.getObjective()+e.getIncome()+e.getTimeFrame()+e.getLiquidity()+e.getExperience()+e.getStockExperience()+e.getBondExperience())/8*10*e.data.repeatSelect,i=t.currentUser;i.suitabilityScore=n,i.badMatches=[],i.badMatchRatios=[],i.okayMatches=[],i.okayMatchRatios=[],i.goodMatches=[],i.goodMatchRatios=[],i.bestMatches=[],i.bestMatchRatios=[],i.questionaire=!0,t.currentUser=i,e.successMessage="Score Saved!",c.updateUser(i).then(function(n){e.disabled=!1,r.go("portfolio")})}}]);
angular.module("SashasApp").controller("userController",["$scope","$state","$cookies","$localStorage","mainService","fundService",function(t,r,e,o,a,i){t.currentUserCookie=o.currentUser,t.$watch(t.currentUserCookie),t.currentUserPortfolioCookie=o.currentUserPortfolio,t.$watch(t.currentUserPortfolioCookie),t.currentUserBadMatchesCookie=o.currentUserBadMatches,t.$watch(t.currentUserBadMatchesCookie),t.currentUserOkayMatchesCookie=o.currentUserOkayMatches,t.$watch(t.currentUserOkayMatchesCookie),t.currentUserGoodMatchesCookie=o.currentUserGoodMatches,t.$watch(t.currentUserGoodMatchesCookie),t.currentUserBestMatchesCookie=o.currentUserBestMatches,t.$watch(t.currentUserBestMatchesCookie),t.chartData=o.chartData,t.disabled=void 0,t.labels=o.goodBarData.labels,t.series=o.goodBarData.series,t.data=[o.goodBarData.data],o.currentUser.portfolioPrice=0,t.calcRunning=!1,t.getBarInfo=function(){o.goodBarData={},o.goodBarData.data=[],o.goodBarData.labels=[],o.goodBarData.series=["Price"],o.bestBarData={},o.bestBarData.data=[],o.bestBarData.labels=[],o.bestBarData.series=["Price"];for(var t=0;t<o.currentUser.bestMatches.length;t++)a.getMoreInformation(o.currentUserBestMatches.bestMatches[t].symbol.toUpperCase()).then(function(t){o.goodBarData.data.push(parseInt(t.data.query.results.quote.PreviousClose)),o.goodBarData.labels.push(t.data.query.results.quote.Symbol)});for(var t=0;t<o.currentUser.goodMatches.length;t++)a.getMoreInformation(o.currentUserGoodMatches.goodMatches[t].symbol.toUpperCase()).then(function(t){o.goodBarData.data.push(parseInt(t.data.query.results.quote.PreviousClose)),o.goodBarData.labels.push(t.data.query.results.quote.Symbol)})},t.changeShareNumber=function(r,e){if(e)for(var i=0;i<o.currentUserPortfolio.portfolioNumber.length;i++){if(1===o.currentUserPortfolio.portfolioNumber.length){var s=o.currentUserPortfolio;s.portfolioNumber[0].number=e,a.updateUser(s),a.getUserPortfolio(o.currentUser.username).then(function(r){o.currentUserPortfolio=r.data,t.currentUserPortfolioCookie=o.currentUserPortfolio})}if(r.toUpperCase()===o.currentUserPortfolio.portfolioNumber[i].name.toUpperCase()&&o.currentUserPortfolio.portfolioNumber.length>1){var s=o.currentUserPortfolio;s.portfolioNumber[i].number=e,e="",a.updateUser(s),a.getUserPortfolio(o.currentUser.username).then(function(r){o.currentUserPortfolio=r.data,t.currentUserPortfolioCookie=o.currentUserPortfolio})}}},t.getChartInfo=function(e){t.disabled=!0,a.chartData={},a.chartData.data=[],a.getChartInfo(e.toUpperCase()).then(function(s){for(var u=0;u<s.data.query.results.quote.length;u++){var n=(s.data.query.results.quote[u].Date.split("-"),{});n.Open=s.data.query.results.quote[u].Open,n.Low=s.data.query.results.quote[u].Low,n.High=s.data.query.results.quote[u].High,n.Close=s.data.query.results.quote[u].Close,n.Volume=s.data.query.results.quote[u].Volume,n.Date=s.data.query.results.quote[u].Date,n._date_Date=n.Date,a.chartData.data.push(n)}o.chartData=a.chartData,t.chartData=o.chartData,a.getMoreInformation(e).then(function(s){a.specificData=s.data.query.results.quote,o.fundData=a.specificData,t.lineData=[],t.lineData[0]=[],t.lineData[1]=[],t.lineData[2]=[],t.lineLabels=[];for(var u=t.chartData.data.reverse(),n=0;n<t.chartData.data.length;n++)t.lineLabels.push(u[n].Date),t.lineData[0].push(u[n].High),t.lineData[1].push(u[n].Low),t.lineData[2].push(u[n].Open);o.data=t.lineData,o.labels=t.lineLabels,u=null,i.searchFund(e).then(function(e){o.fundData=e.data.list.resources[0].resource.fields,t.disabled=!1,r.go("fundinfo")})})})},t.getCompatibleFunds=function(){var t=o.currentUser;t.questionaire?(t.okayMatches=[],t.bestMatches=[],t.goodMatches=[],t.badMatches=[],t.okayMatchRatios=[],t.bestMatchRatios=[],t.goodMatchRatios=[],t.badMatchRatios=[],i.getFund().then(function(e){for(var i=0;i<e.data.length;i++)e.data[i].riskCompatibility/t.suitabilityScore<=1.1&&e.data[i].riskCompatibility/t.suitabilityScore>=.9?t.bestMatches.includes(e.data[i]._id)||(t.bestMatches.push(e.data[i]._id),t.bestMatchRatios.push({compatibilityRatio:e.data[i].riskCompatibility/t.suitabilityScore}),a.updateUser(t),o.currentUser=t):e.data[i].riskCompatibility/t.suitabilityScore<.9&&e.data[i].riskCompatibility/t.suitabilityScore>=.7?t.goodMatches.includes(e.data[i]._id)||(t.goodMatches.push(e.data[i]._id),t.goodMatchRatios.push({compatibilityRatio:e.data[i].riskCompatibility/t.suitabilityScore}),a.updateUser(t),o.currentUser=t):e.data[i].riskCompatibility/t.suitabilityScore<=1.3&&e.data[i].riskCompatibility/t.suitabilityScore>1.1?t.goodMatches.includes(e.data[i]._id)||(t.goodMatches.push(e.data[i]._id),t.goodMatchRatios.push({compatibilityRatio:e.data[i].riskCompatibility/t.suitabilityScore}),a.updateUser(t),o.currentUser=t):e.data[i].riskCompatibility/t.suitabilityScore<=1.5&&e.data[i].riskCompatibility/t.suitabilityScore>1.3?t.goodMatches.includes(e.data[i]._id)||(t.okayMatches.push(e.data[i]._id),t.okayMatchRatios.push({compatibilityRatio:e.data[i].riskCompatibility/t.suitabilityScore}),a.updateUser(t),o.currentUser=t):e.data[i].riskCompatibility/t.suitabilityScore<.7&&e.data[i].riskCompatibility/t.suitabilityScore>=.5?t.okayMatches.includes(e.data[i]._id)||(t.okayMatches.push(e.data[i]._id),t.okayMatchRatios.push({compatibilityRatio:e.data[i].riskCompatibility/t.suitabilityScore}),a.updateUser(t),o.currentUser=t):e.data[i].riskCompatibility/t.suitabilityScore<.5&&e.data[i].riskCompatibility/t.suitabilityScore>=0?t.badMatches.includes(e.data[i]._id)||(t.badMatches.push(e.data[i]._id),t.badMatchRatios.push({compatibilityRatio:e.data[i].riskCompatibility/t.suitabilityScore}),a.updateUser(t),o.currentUser=t):e.data[i].riskCompatibility/t.suitabilityScore<=2&&e.data[i].riskCompatibility/t.suitabilityScore>1.5&&(t.badMatches.includes(e.data[i]._id)||(t.badMatches.push(e.data[i]._id),t.badMatchRatios.push({compatibilityRatio:e.data[i].riskCompatibility/t.suitabilityScore}),a.updateUser(t),o.currentUser=t));a.getBadMatches(o.currentUser.username).then(function(t){o.currentUserBadMatches=t.data,a.getOkayMatches(o.currentUser.username).then(function(t){o.currentUserOkayMatches=t.data,a.getGoodMatches(o.currentUser.username).then(function(t){o.currentUserGoodMatches=t.data,a.getBestMatches(o.currentUser.username).then(function(t){o.currentUserBestMatches=t.data,r.go("recommendations")})})})})})):(console.log("false"),r.go("questionaire"))},t.checkPortfolio=function(t){for(var r=0;r<o.currentUserPortfolio.portfolio.length;r++)return t===o.currentUserPortfolio.portfolio[r]._id},t.removeFromPortfolio=function(e){if(1===o.currentUser.portfolio.length){var i=o.currentUser;i.portfolio=[],i.portfolioNumber=[],o.currentUser=i,a.updateUser(i),a.getUserPortfolio(o.currentUser.username).then(function(e){o.currentUserPortfolio=e.data,t.currentUserPortfolioCookie=o.currentUserPortfolio,r.reload()})}a.getUserPortfolio(o.currentUser.username).then(function(r){o.currentUserPortfolio=r.data,t.currentUserPortfolioCookie=o.currentUserPortfolio});for(var s=0;s<o.currentUser.portfolio.length;s++)if(e===o.currentUser.portfolio[s]){var u=o.currentUser;u.portfolio.splice(s,1),u.portfolioNumber.splice(s,1),o.currentUser=u,a.updateUser(u),a.getUserPortfolio(o.currentUser.username).then(function(e){o.currentUserPortfolio=e.data,t.currentUserPortfolioCookie=o.currentUserPortfolio,r.reload()})}},t.removeRecommendedFromPortfolio=function(e){if(1===o.currentUser.portfolio.length){var i=o.currentUser;i.portfolio=[],i.portfolioNumber=[],o.currentUser=i,a.updateUser(i),a.getUserPortfolio(o.currentUser.username).then(function(e){o.currentUserPortfolio=e.data,t.currentUserPortfolioCookie=o.currentUserPortfolio,r.reload()})}a.getUserPortfolio(o.currentUser.username).then(function(r){o.currentUserPortfolio=r.data,t.currentUserPortfolioCookie=o.currentUserPortfolio});for(var s=0;s<o.currentUser.portfolio.length;s++)if(e===o.currentUser.portfolio[s]){var u=o.currentUser;u.portfolio.splice(s,1),u.portfolioNumber.splice(s,1),o.currentUser=u,a.updateUser(u),a.getUserPortfolio(o.currentUser.username).then(function(e){o.currentUserPortfolio=e.data,t.currentUserPortfolioCookie=o.currentUserPortfolio,r.reload()})}},t.addRecommendedToPortfolio=function(e,i,s){if(s){for(var u=o.currentUser,n=0;n<u.portfolio.length;n++)if(e===o.currentUser.portfolio[n])return!1;u.portfolio.push(e),u.portfolioNumber.push({number:s,name:i}),s="",o.currentUser=u,t.currentUserCookie=o.currentUser,a.updateUser(u),a.getUserPortfolio(u.username).then(function(e){o.currentUserPortfolio=e.data,t.currentUserPortfolioCookie=o.currentUserPortfolio,r.reload()})}},t.checkUserCookie=function(){console.log("yes",o.currentUser),console.log("hello",o.currentUserPortfolio)},t.checkPortfolio=function(t){for(var r=o.currentUser,e=0;e<r.portfolio.length;e++)if(t===o.currentUser.portfolio[e])return!0;return!1},t.getMoreInformation=function(t){a.getMoreInformation(t).then(function(t){o.fundData=t.data.query.results.quote,r.reload()})}}]);
angular.module("SashasApp").directive("login",function(){return{restrict:"E",templateUrl:"login.html",controller:"loginController"}});
angular.module("SashasApp").directive("register",function(){return{restrict:"E",templateUrl:"register.html",controller:"registerController"}});
angular.module("SashasApp").factory("AuthService",["$q","$timeout","$http","$state","$cookies",function(e,r,s,t,u){function n(){return null===JSON.stringify(u.get("currentUser"))?user=null:user=!0,!!user}function o(){s.get("/user/status").success(function(e){e.status?user=!0:user=!1}).error(function(e){user=!1})}function c(r,t){var u=e.defer();return s.post("/user/login",{username:r,password:t}).success(function(e,r){200===r&&e.status?(user=!0,u.resolve(e.user)):(user=!1,u.reject())}).error(function(e){user=!1,u.reject()}),u.promise}function i(){var r=e.defer();return s.get("/user/logout").success(function(e){user=!1,u.remove("currentUser"),r.resolve()}).error(function(e){user=!1,r.reject()}),r.promise}function a(r,t,u,n,o){var c=e.defer();return s.post("/user/register",{username:r,password:t,firstName:u,lastName:n,email:o}).success(function(e,r){200===r&&e.status?c.resolve():c.reject()}).error(function(e){c.reject()}),c.promise}return this.currentUser=u.get("currentUser"),{isLoggedIn:n,getUserStatus:o,login:c,logout:i,register:a}}]);
angular.module("SashasApp").service("fundService",["$http","$q","$cookies",function(n,t,u){this.getFund=function(){return n.get("/fund")},this.searchFund=function(t){return n.jsonp("http://finance.yahoo.com/webservice/v1/symbols/"+t+"/quote?format=json&view=detail&callback=JSON_CALLBACK")},this.newFund=function(t){n.post("/fund",t)},this.fundQuery=function(t){return n.get("/fund/specific?id="+t)},this.updateFund=function(t,u){return n.put("/fund?id="+t,u)},this.deleteFund=function(t){return n({method:"DELETE",url:"/fund?id="+t}).then(function(n){return n},function(n){return n})}}]);
angular.module("SashasApp").service("mainService",["$http","$q","$localStorage","$cookies",function(t,e,a,o){this.data=[];var s=new Date,n=(new Date).toDateString().slice(3),n=n.split(" "),n=n.slice(1),n=[n[2],s.getMonth()+1,n[1]],r=n[0]+"-"+n[1]+"-"+n[2],i=n[0]-1,u=i+"-"+n[1]+"-"+n[2];this.getMoreInformation=function(e){return t.get("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20IN%20(%22"+e+"%22,%22"+e+"%22)&format=json&env=http://datatables.org/alltables.env")},this.updateUser=function(e){return t.put("user?id="+a.currentUser._id,e)},this.getUserPortfolio=function(e){return t.get("user/portfolio?username="+e)},this.getBadMatches=function(e){return t.get("user/badmatches?username="+e)},this.getOkayMatches=function(e){return t.get("user/okaymatches?username="+e)},this.getGoodMatches=function(e){return t.get("user/goodmatches?username="+e)},this.getBestMatches=function(e){return t.get("user/bestmatches?username="+e)},this.getChartInfo=function(e){return t.jsonp('http://query.yahooapis.com/v1/public/yql?q= select * from   yahoo.finance.historicaldata          where  symbol    = "'+e+'"          and    startDate = "'+u+'"          and    endDate   = "'+r+'" &format=json &diagnostics=true &env=store://datatables.org/alltableswithkeys &callback=JSON_CALLBACK')},this.getMutualInfo=function(e){return t.jsonp("http://finance.yahoo.com/webservice/v1/symbols/"+e+"/quote?format=json&view=detail&callback=JSON_CALLBACK")}}]);
angular.module("SashasApp").service("questionaireService",["$http","$q","$cookies",function(e,i,a){}]);