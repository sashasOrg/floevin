angular.module("SashasApp",["ui.router","ngCookies"]),angular.module("SashasApp").config(["$stateProvider","$urlRouterProvider",function(t,r){t.state("home",{url:"/",templateUrl:"/home.html",controller:"mainController",access:{restricted:!1}}).state("form",{url:"/form",templateUrl:"/form.html",controller:"formController",access:{restricted:!1}}).state("login",{url:"/login",templateUrl:"/login.html",controller:"loginController",access:{restricted:!1}}).state("register",{url:"/register",templateUrl:"/register.html",controller:"registerController",access:{restricted:!1}}).state("portfolio",{url:"/portfolio",templateUrl:"/portfolio.html",controller:"userController",access:{restricted:!1}}).state("stock",{url:"/stock",templateUrl:"/stock.html",controller:"mainController",access:{restricted:!1}}).state("fundinfo",{url:"/fundinfo",templateUrl:"/fundinfo.html",controller:"formController",access:{restricted:!1}}).state("admin",{url:"/admin",templateUrl:"/admin.html",controller:"formController",access:{restricted:!1}}),r.otherwise("/")}]),angular.module("SashasApp").run(["$state","$rootScope","$location","AuthService",function(t,r,e,o){r.$on("$stateChangeStart",function(r,e,l){o.getUserStatus(),e.access.restricted&&!o.isLoggedIn()&&(r.preventDefault(),t.go("login"))})}]);
angular.module("SashasApp").controller("loginController",["$state","$scope","$location","$cookies","AuthService","mainService",function(o,e,r,n,i,t){e.isLoggedIn=i.isLoggedIn,e.login=function(){e.error=!1,e.disabled=!0,i.login(e.loginForm.username,e.loginForm.password).then(function(r){n.put("currentUser",JSON.stringify(r)),e.disabled=!1,e.loginForm={},i.isLoggedIn(),o.go("portfolio")})["catch"](function(){e.error=!0,e.errorMessage="Invalid username and/or password",e.disabled=!1,e.loginForm={}})}}]),angular.module("SashasApp").controller("logoutController",["$scope","$location","AuthService","mainService",function(o,e,r,n){o.userLogged=r.isLoggedIn(),o.$watch(o.userLogged),o.logout=function(){r.logout().then(function(){n.currentUser={},n.userPageUser={},e.path("login")}),console.log("logout")}}]),angular.module("SashasApp").controller("registerController",["$scope","$location","AuthService",function(o,e,r){o.register=function(){o.error=!1,o.disabled=!0,console.log(o.registerForm),r.register(o.registerForm.username,o.registerForm.password,o.registerForm.firstName,o.registerForm.lastName,o.registerForm.email).then(function(){e.path("login"),o.disabled=!1,o.registerForm={}})["catch"](function(){o.error=!0,o.errorMessage="Something went wrong!",o.disabled=!1,o.registerForm={}})}}]);
angular.module("SashasApp").controller("formController",["$scope","formService",function(n,e){n.seachFund="",n.anyfund=function(){console.log("test"),n.error=!1,n.disabled=!0,e.newFund(n.newfundForm)},n.fundQuery=function(){e.fundQuery(n.searchFund).then(function(e){n.fund=e})},n.getFund=function(){e.getFund().then(function(e){n.fundinfo=e.data})},n.getFund(),n.newFund=function(o,u,t,i,d,r,c,f){e.newFund(o,u,t,i,d,r,c,f).then(function(e){n.getFund()})},n.toggle=function(){n.showing=!n.showing},n.showing=!1}]),angular.module("SashasApp").directive("hideForm",function(){function n(n,e,o){var u=o.hideForm;n.$eval(u)||e.hide(),n.$watch(u,function(n,o){n!==o&&(n?e.stop(!0,!0).slideDown():e.stop(!0,!0).slideUp())})}return{link:n,restrict:"A"}});
angular.module("SashasApp").controller("mainController",["$scope","$state","$cookies","mainService",function(e,a,t,o){e.data=o.data,e.specificData=o.specificData,e.stockQuery="",e.mainService={},e.searchSymbols=function(){o.searchSymbols(e.stockQuery).then(function(e){o.data=e.data.ResultSet.Result,a.reload()})},e.getMoreInformation=function(e){o.getMoreInformation(e).then(function(e){o.specificData=e.data.query.results.quote,console.log(o.specificData),a.reload()})}}]);
angular.module("SashasApp").controller("userController",["$scope","$cookies","mainService",function(e,r,o){e.currentUserCookie=JSON.parse(r.get("currentUser"))}]);
angular.module("SashasApp").factory("AuthService",["$q","$timeout","$http","$state","$cookies",function(e,r,s,t,u){function n(){return null===JSON.stringify(u.get("currentUser"))?user=null:user=!0,!!user}function o(){s.get("/user/status").success(function(e){e.status?user=!0:user=!1}).error(function(e){user=!1})}function c(r,t){var n=e.defer();return s.post("/user/login",{username:r,password:t}).success(function(e,r){200===r&&e.status?(user=!0,console.log(u.get("currentUser")),n.resolve(e.user)):(user=!1,n.reject())}).error(function(e){user=!1,n.reject()}),n.promise}function i(){var r=e.defer();return s.get("/user/logout").success(function(e){user=!1,u.remove("currentUser"),r.resolve()}).error(function(e){user=!1,r.reject()}),r.promise}function a(r,t,u,n,o){var c=e.defer();return s.post("/user/register",{username:r,password:t,firstName:u,lastName:n,email:o}).success(function(e,r){200===r&&e.status?c.resolve():c.reject()}).error(function(e){c.reject()}),c.promise}return this.currentUser=u.get("currentUser"),{isLoggedIn:n,getUserStatus:o,login:c,logout:i,register:a}}]);
angular.module("SashasApp").service("formService",["$http","$q",function(n,t){this.getFund=function(){return n.get("/fund")},this.newFund=function(t){console.log(t),n.post("/fund",t)},this.fundQuery=function(t){return n.get("/fund/specific?id="+t)},this.updateFund=function(t){return n.put("/fund"+t,update)},this.deleteFund=function(t){n({method:"DELETE",url:"/fund?id="+t}).then(function(n){return n},function(n){return n})}}]);
angular.module("SashasApp").service("mainService",["$http","$q",function(t,e){this.data=[],this.searchSymbols=function(e){return t.jsonp("http://d.yimg.com/aq/autoc?query="+e+"&region=US&lang=en-US&callback=JSON_CALLBACK")},this.getMoreInformation=function(e){return t.get("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20IN%20(%22"+e+"%22,%22"+e+"%22)&format=json&env=http://datatables.org/alltables.env")}}]);
angular.module("SashasApp").service("userService",["$http",function(e){}]);